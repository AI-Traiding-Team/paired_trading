https://apptractor.ru/develop/user-story-plan-deystviy-dlya-razrabotchika.html

# User Story: план действий для разработчика


Итак, в рамках [FintechHack 2021](https://codenrock.com/contests/fintechack/) хакатона, мы решаем следующую задачу:

**2. Написать на Python стратегию, работающую на любых таймфреймах от 1 до 15 минут для криптомонет из списка TOP10 по капитализации.**

----
- Все эксперименты проводим с seed=42 (в т.ч. закрепляем его для фреймворков НС)
- Используем только 15 минутки (у данных малый вес). Я выложил их в `source_root`. Ничто не помешает потом взять любые другие таймфреймы
- 


## I. Предлагаемые варианты решения, которые точно возможно реализовать до 12/12/2021
1. Предсказание относительных разностей расхождения пар - задача регрессии
2. Предсказание направление движения п1 [0, 1] - классификация
3. Предсказание силы движения (п1 переводим в ohe [-5, -4, -3, -3, -1, 1, 2, 3, 4, 5]) - классификация
4. Ансамбль НС (input + НСп1 + НСп2 + НСп3)  и Y = идеальная разметка торговых сделок от Сергея Киликаева - обучаем нейронку торговать
5. Управление портфелем монет с помощью [MPT Марковица](https://habr.com/ru/post/561980/) (Илья)


## II. Задачи:
1. Простейший анализ данных  (Олег и Стас)
- построение динамики всех монет на одном графике
- построение попарных разностей между монетами, чтобы можно было визуально понять, можно ли их торговать
- построение теплограммы корреляции курсов монет, чтобы отобрать те, у которых наибольшая корреляция

Как результат, мы должны выбрать одну и только одну пару, для которой будем писать дальше код.

Тут обязательно нужно учесть мнение Сергея Киликаева!

Дальнейший код должен быть написан так, чтобы мы могли легко использовать любые пары из `source_root`

1. Подготовка данных и фич инжиниринг (Олег и Стас)
- Datetime, разложение даты на:
     
`date = pd.to_datetime(temp['Date'], format='%Y%m%d')`

`temp['week_day'] = date.apply(lambda x: x.weekday())`

`temp['month'] = date.apply(lambda x: x.month)`

`temp['week'] = date.apply(lambda x: x.week)`

`temp['day'] = date.apply(lambda x: x.day)`

`temp['hour'] = date.apply(lambda x: x.hour)`

`temp['minute'] = date.apply(lambda x: x.minute)`
   
- `Close1`, `Close2`, `Value1`, `Value2`
- `Close1 - Close2`
- `np.log(Close1)`, `np.log(Close2)`, `np.log(Value1)`, `np.log(Value2)`
- `Close1.diff()`, `Close2.diff()`
- относительные изменения к предыдущему дню c логарифмированием 
`np.log((Close1)/(Close1.shift(1)))`, `np.log((Close2)/(Close2.shift(1)))`
- синусы от цен: `df['sin_Close1'] = df['Close1'].apply(lambda x: np.sin(x))  # Нормализация Close от 0 до 1 синусом`
- если есть еще идеи, можно обсудить

2. Разметка Y для каждой задачи (Олег и Стас), если потребуется перебор гиперпараметров, то я помогу
- `Close1 - Close2`
- 0 if `Close1 - Close2` < 0 и 1 if `Close1 - Close2` >= 0 - в одном столбце
- п1 переводим в ohe [-5, -4, -3, -3, -1, 1, 2, 3, 4, 5], где цифры надо подобрать из гистограммы распределения `Close1 / Close2`, bins = 10

4. Написание кода Transfer Learning (я предлагаю для всех задач использовать ResNet18). В ней нужно заменить первый слой,
чтобы он принимал одноканальные данные и дальше, по необходмости, менять активацию и число нейронов в последнем слое
Думаю, Олег со Стасом справятся - много информации в туториалах и интернете

5. Обучение НС (все)
6. Написание торговых стратегий для каждого типа задачи (Сергей Чеховских)
7. Backtesting (Сергей Чеховских и, возможно, Сергей Киликаев)
8. Написание форвардного анализа для каждой стратегии (Сергей Чеховских)
9. Написание отчета (Илья и дальше редакция от всех участников)

## III. Нерешенные пока вопросы
1. Как использовать результаты нейронок из пI для прибыльной торговли??? 
Сошлемся на то, что полученную информацию нужно запускать в стратегию на терминале, или таки сам сделаем оптимальную 
разметку для максимизации прибыльности торговли и тогда нейронка из пI.4 будет предсказывать именно оптимальные сделки?

2. 

### IV. Полезные ссылки про парную торговлю с помощью ML:
1. 



